{% extends "template.html" %}

{% block conteudo %}
<div class="container">
    <div class="container-fluid">
        <div class="container">
            <h1>Local/Ocorrência</h1>
        </div>
        <div class="row">
            <!-- Tabela de Setores -->
            <div class="col-md-6 mt-3">
                <div class="row justify-content-end mb-2">
                    <div class="col-auto">
                        <button type="button" class="btn btn-dark" id="addBtnLocal">Cadastrar Local</button>
                    </div>
                </div>
                <table width="100%" id="tabela_local" class="table table-striped tabela">
                </table>
            </div>

            <!-- Tabela de Ocorrência -->
            <div class="col-md-6 mt-3">
                <div class="row justify-content-end mb-2">
                    <div class="col-auto">
                        <button type="button" class="btn btn-dark" id="addBtnOcorrencia">Cadastrar Ocorrência</button>
                    </div>
                </div>
                <table width="100%" id="tabela_ocorrencia" class="table table-striped tabela">
                </table>
            </div>
        </div>
    </div>
</div>

<!-- Modal 01 -->
<div class="modal fade" id="modal01" tabindex="-1" aria-labelledby="modal01" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Cadastrar Local</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body">
                <!-- Formulário dentro do modal -->
                <form>
                    <input type="hidden" class="form-control" id="id_local" name="id_local">
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="local" class="form-label">Local:</label>
                            <input type="text" class="form-control" id="local" name="local" value="">
                            <span style="font-size: 12px;">30 caracteres restantes</span>
                        </div>

                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-dark" id="saveBtnLocal">Salvar</button>
            </div>
        </div>
    </div>
</div>

<!-- Modal 02 -->
<div class="modal fade" id="modal02" tabindex="-1" aria-labelledby="modal02" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="exampleModalLabel">Cadastrar Ocorrência</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Fechar"></button>
            </div>
            <div class="modal-body">
                <!-- Formulário dentro do modal -->
                <form>
                    <input type="hidden" class="form-control" id="id_ocorrencia" name="id_ocorrencia">
                    <div class="row mb-3">
                        <div class="col-md-12">
                            <label for="ocorrencia" class="form-label">Ocorrência:</label>
                            <input type="text" class="form-control" id="ocorrencia" name="ocorrencia" value="">
                            <span style="font-size: 12px;">100 caracteres restantes</span>
                        </div>
                    </div>
                </form>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Fechar</button>
                <button type="button" class="btn btn-dark" id="saveBtnOcorrencia">Salvar</button>
            </div>
        </div>
    </div>
</div>
{% endblock %}
    
{% block javascript %}
<script>
    const getColumnDefs = () => [
        { targets: '_all', className: 'text-center' },
    ];
    
    const getTableColumnsLocal = () => [
        { data: 'local', title: 'Local' },
        { data: null, title: 'Ações', defaultContent: '' },
    ];
    
    const getTableColumnsOcorrencia = () => [
        { data: 'ocorrencia', title: 'Ocorrência' },
        { data: null, title: 'Ações', defaultContent: '' },
    ];
    
    Promise.all([
        carregarDadosDatatable(`{{ url_for('listaDeLocal') }}`),
        carregarDadosDatatable(`{{ url_for('listaDeOcorrencia') }}`)
    ]).then(([dadosLocais, dadosOcorrencias]) => {
        getTableColumns = getTableColumnsLocal;
        carregarDatatable('#tabela_local', dadosLocais);
    
        getTableColumns = getTableColumnsOcorrencia;
        carregarDatatable('#tabela_ocorrencia', dadosOcorrencias);
    });
    </script>
{% endblock %}